{"version":3,"file":"Auth-dbvjWqwn.js","sources":["../../../../../src/hooks/useMutation.ts","../../../../../src/components/Auth.tsx"],"sourcesContent":["import * as React from 'react'\n\nexport function useMutation<TVariables, TData, TError = Error>(opts: {\n  fn: (variables: TVariables) => Promise<TData>\n  onSuccess?: (ctx: { data: TData }) => void | Promise<void>\n}) {\n  const [submittedAt, setSubmittedAt] = React.useState<number | undefined>()\n  const [variables, setVariables] = React.useState<TVariables | undefined>()\n  const [error, setError] = React.useState<TError | undefined>()\n  const [data, setData] = React.useState<TData | undefined>()\n  const [status, setStatus] = React.useState<\n    'idle' | 'pending' | 'success' | 'error'\n  >('idle')\n\n  const mutate = React.useCallback(\n    async (variables: TVariables): Promise<TData | undefined> => {\n      setStatus('pending')\n      setSubmittedAt(Date.now())\n      setVariables(variables)\n      //\n      try {\n        const data = await opts.fn(variables)\n        await opts.onSuccess?.({ data })\n        setStatus('success')\n        setError(undefined)\n        setData(data)\n        return data\n      } catch (err: any) {\n        setStatus('error')\n        setError(err)\n      }\n    },\n    [opts.fn],\n  )\n\n  return {\n    status,\n    variables,\n    submittedAt,\n    mutate,\n    error,\n    data,\n  }\n}\n","export function Auth({\n  actionText,\n  onSubmit,\n  status,\n  afterSubmit,\n}: {\n  actionText: string\n  onSubmit: (e: React.FormEvent<HTMLFormElement>) => void\n  status: 'pending' | 'idle' | 'success' | 'error'\n  afterSubmit?: React.ReactNode\n}) {\n  return (\n    <div className=\"fixed inset-0 bg-white dark:bg-black flex items-start justify-center p-8\">\n      <div className=\"bg-white dark:bg-gray-900 p-8 rounded-lg shadow-lg\">\n        <h1 className=\"text-2xl font-bold mb-4\">{actionText}</h1>\n        <form\n          onSubmit={(e) => {\n            e.preventDefault()\n            onSubmit(e)\n          }}\n          className=\"space-y-4\"\n        >\n          <div>\n            <label htmlFor=\"email\" className=\"block text-xs\">\n              Username\n            </label>\n            <input\n              type=\"email\"\n              name=\"email\"\n              id=\"email\"\n              className=\"px-2 py-1 w-full rounded border border-gray-500/20 bg-white dark:bg-gray-800\"\n            />\n          </div>\n          <div>\n            <label htmlFor=\"password\" className=\"block text-xs\">\n              Password\n            </label>\n            <input\n              type=\"password\"\n              name=\"password\"\n              id=\"password\"\n              className=\"px-2 py-1 w-full rounded border border-gray-500/20 bg-white dark:bg-gray-800\"\n            />\n          </div>\n          <button\n            type=\"submit\"\n            className=\"w-full bg-cyan-600 text-white rounded py-2 font-black uppercase\"\n            disabled={status === 'pending'}\n          >\n            {status === 'pending' ? '...' : actionText}\n          </button>\n          {afterSubmit ? afterSubmit : null}\n        </form>\n      </div>\n    </div>\n  )\n}\n"],"names":["useMutation","opts","submittedAt","setSubmittedAt","React.useState","variables","setVariables","error","setError","data","setData","status","setStatus","mutate","React.useCallback","_a","err","Auth","actionText","onSubmit","afterSubmit","jsxs","jsx","e"],"mappings":"uXAEO,SAASA,EAA+CC,EAG5D,CACD,KAAM,CAACC,EAAaC,CAAc,EAAIC,WAAM,EACtC,CAACC,EAAWC,CAAY,EAAIF,WAAM,EAClC,CAACG,EAAOC,CAAQ,EAAIJ,WAAM,EAC1B,CAACK,EAAMC,CAAO,EAAIN,WAAM,EACxB,CAACO,EAAQC,CAAS,EAAIR,EAAAA,SAE1B,MAAM,EAEFS,EAASC,EAAAA,YACb,MAAOT,GAAsD,OAC3DO,EAAU,SAAS,EACnBT,EAAe,KAAK,KAAK,EACzBG,EAAaD,CAAS,EAEtB,GAAI,CACF,MAAMI,EAAO,MAAMR,EAAK,GAAGI,CAAS,EACpC,cAAMU,EAAAd,EAAK,YAAL,YAAAc,EAAA,KAAAd,EAAiB,CAAE,KAAAQ,KACzBG,EAAU,SAAS,EACnBJ,EAAS,MAAS,EAClBE,EAAQD,CAAI,EACLA,CAAA,OACAO,EAAU,CACjBJ,EAAU,OAAO,EACjBJ,EAASQ,CAAG,CAAA,CACd,EAEF,CAACf,EAAK,EAAE,CAAA,EAGV,MAAO,CACL,OAAAU,EACA,UAAAN,EACA,YAAAH,EACA,OAAAW,EACA,MAAAN,EACA,KAAAE,CAAA,CAEJ,CC3CO,SAASQ,EAAK,CACnB,WAAAC,EACA,SAAAC,EACA,OAAAR,EACA,YAAAS,CACF,EAKG,CACD,aACG,MAAA,CAAI,UAAU,2EACb,SAAAC,EAAAA,KAAC,MAAA,CAAI,UAAU,qDACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,0BAA2B,SAAAJ,EAAW,EACpDG,EAAAA,KAAC,OAAA,CACC,SAAWE,GAAM,CACfA,EAAE,eAAA,EACFJ,EAASI,CAAC,CAAA,EAEZ,UAAU,YAEV,SAAA,CAAAF,OAAC,MAAA,CACC,SAAA,CAAAC,MAAC,QAAA,CAAM,QAAQ,QAAQ,UAAU,gBAAgB,SAAA,WAEjD,EACAA,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,KAAK,QACL,GAAG,QACH,UAAU,8EAAA,CAAA,CACZ,EACF,SACC,MAAA,CACC,SAAA,CAAAA,MAAC,QAAA,CAAM,QAAQ,WAAW,UAAU,gBAAgB,SAAA,WAEpD,EACAA,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,KAAK,WACL,GAAG,WACH,UAAU,8EAAA,CAAA,CACZ,EACF,EACAA,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,UAAU,kEACV,SAAUX,IAAW,UAEpB,SAAAA,IAAW,UAAY,MAAQO,CAAA,CAAA,EAEjCE,GAA4B,IAAA,CAAA,CAAA,CAC/B,CAAA,CACF,CAAA,CACF,CAEJ"}